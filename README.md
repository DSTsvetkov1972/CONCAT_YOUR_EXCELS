# CONCAT_YOUR_EXCELS

---
### Назначение:
Программа позволяет быстро объединять в одну таблицу большое количество экселевских таблиц раскиданных в разных экселевских книгах на разных листах.<br>
Заголовки таблиц могут располагаться в разных строках (где-то, например, на третьей строке, а где-то на пятой) и начинаться с разных колонок. Названия колонок могут иметь разный порядок. Значения колонок с одинаковыми названиями попадают в одну колонку итоговой таблицы.<br>
Пользователь может выбрать листы в книгах Эксель таблицы с которых должны быть объединены.<br>
Программа позволяет объеденить экселевские файлы быстрее (примероно в 10 раз) и удобнее чем средствами Power Query. Так же программа показывет прогресс обработки, что не возможно реализовать используя Power Query.
Результат выгружается в CSV-файл, так как итоговая таблица может иметь количество строк превышающее допустимое в Эксель.<br>
Из итогового результата автоматически вычищаются пустые строки и колонки.

---
### Как пользоваться:

1. Настройте Эксель. Для этого выберете: **Данные => Получить данные => Параметры запроса => Конфеденциальность => Глобальные => Всегда игнорировать параметры уровней кофиденциальности**
2. Создайте папку проекта.
2. В папке проекта создайте папку **Исходники**. В папку **Исходники** поместите экселевские файлы таблицы на листах которых должны быть объеденены. Экселевские файлы могут расоплогаться как непосредственно в самой папке **Исходники**, так и во вложенных папках (допускается любой уровень вложенности).<br>
3. Скопируйте в папку проекта файлы 
    - **.headers.xlsx**
    - **.sheets.xlsx**
    - **.statistics.xlsx**
    - **CONCAT_YOUR_EXCELS.exe** (для создания файла используйте скрипт **auto-py-to-exe** с настройками: **One File, Console Based** )
4. Запустите программу **CONCAT_YOUR_EXCELS.exe**
5. В ячейку A2 введите путь к папке проекта без "\" на конце. Ячейка A4 содержит количество строк в которых будут искаться заголовки в исходных таблицах. Слишком большое значение в этой ячейке может быть причиной замедления предобработки для больших таблиц.
6. Перейдите на лист **Sheets_in_book** и нажмите кнопку **Получить список листов в книгах**. В получившейся таблице перечислены все книги эксель в папке **Исходники**. В колонке **Отбираем для слияния** проставьте **ДА** для листов, таблицы с которых должны быть добавлены в итоговую таблицу. Для листов которые не нужно обрабатывать ячейка в этой колонки должна быть пустой.
7. Перейдите на лист **Columns in book** и нажмите кнопку **Посмотерь количество столбцов**. Если количество столбцов на каких-либо листах покажется вам подозрительным, откройте соответствующие книги и при необходимости откорректируйте находящуюся там информацию.
8. Откройте какую-либо книгу из папки **Исходники** (в данном расположении эта папка содержит тестовые книги Эксель для объяснения как работать с программой). Определите признак заголовка. Например для книги **Test1.xlsx** (существует в данном расположении для объяснения как работать с программой) для листа **Ноябрь** признак заголовка "№" в колонке 2. Обратите внимание: ячейка A1 изначально была пустой и былы отформатирована в желтый цвет для корректной обработки UserRange. Перейдите на лист **Settings** и в внесите в таблицу номер колонки "2" и значение "пп №".
<br>* **Внимание: таблица на листе Settings книги _CONCAT_YOUR_EXCELS (предобработка).xlsm не должна содержать пустых строк!** *
<br>Перейдите на лист **Titles_in_book** и нажмите кнопку **Подтянуть заголовки**. В таблице отобразятся номер строки и заголовки для листов в которых удастя найти заголовки по указанному признаку. Откройте любую книгу для которой заголовки найти не удалось и посмотрите по какому признаку заголовки можно определить для этого листа. Например для **Test2.xlsx** для листа **Октябрь 2023** это 4 колонка и значение "Пункт". Добавьте в таблицу на листе **Settings** книги **_CONCAT_YOUR_EXCELS (предобработка).xlsm** строку "4","Пункт". Перейдите на лист **Titles_in_book** и нажмите кнопку **Подтянуть заголовки**. Повторяйте процедуру для листов для которых не удалось найти заголовки, пока вся таблица не окажется заполненной. Если по непонятным причинам остаются незаполненные строки, проверьте чтобы на соответствующих листах была заполнена ячейка A1 и значение ячейки A4 книги **_CONCAT_YOUR_EXCELS (предобработка).xlsm** на листе **Settings** было достаточным, чтобы строки с заголовками были просмотрены в процессе предобработки.
9. Сохраните книгу **_CONCAT_YOUR_EXCELS (предобработка).xlsm**
10. Если файл **_CONCAT_YOUR_EXCELS.csv** существует в папке проекта, убедитесь что он закрыт и запустите программу **_CONCAT_YOUR_EXCELS.exe**
11. В случае если некоторые таблицы окажется невозможным обработать (например по причине того что для них не найдены заголовки), выполнение программы будет прерываться всплывающим окном с предупреждением. Если нажать "ОК", выполнение продолжится, но таблица не будет добавлена в результат. Выполнение можно прервать полностью если закрыть окно программы.<br>
Результат выполнения программы будет сохранен в файле **_CONCAT_YOUR_EXCELS.csv** 
